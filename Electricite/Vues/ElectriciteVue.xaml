<Page
    x:Class="GestionnaireDeLogement.Vues.ElectriciteVue"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:GestionnaireDeLogement.Vues"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="ElectriciteVue"
    d:DesignHeight="800"
    d:DesignWidth="1200"
    Background="{StaticResource FondSecondaire}"
    mc:Ignorable="d">

    <!--
    =============================================================
     Gestionnaire de Logement
     Module Chauffage

     Copyright © 2026 Flo
     Licence : CC BY-NC 4.0
     Usage commercial interdit
    =============================================================
    -->
    
    <!--  ══════════════════════════════════════════════════════════  -->
    <!--  RESSOURCES LOCALES  -->
    <!--  ══════════════════════════════════════════════════════════  -->
    <Page.Resources>
        <!--  Style pour les cartes  -->
        <Style x:Key="Carte" TargetType="Border">
            <Setter Property="Background" Value="White" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Padding" Value="25" />
            <Setter Property="Margin" Value="0,0,0,20" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect
                        BlurRadius="15"
                        Direction="270"
                        Opacity="0.1"
                        ShadowDepth="3"
                        Color="#000000" />
                </Setter.Value>
            </Setter>
        </Style>

        <!--  Style pour les cartes de statistiques  -->
        <Style x:Key="CarteStatistique" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource FondInfoClaire}" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="Margin" Value="0,0,15,0" />
        </Style>

        <!--  Style pour les boutons  -->
        <Style x:Key="BoutonPrincipal" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource CouleurPrincipale}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Padding" Value="20,12" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#1976D2" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#1565C0" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#BDBDBD" />
                                <Setter TargetName="border" Property="Opacity" Value="0.6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  Style pour les items de la ListView  -->
        <Style x:Key="ListViewItemStyle" TargetType="ListViewItem">
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
            <Setter Property="Padding" Value="15,12" />
            <Setter Property="Margin" Value="0" />
            <Setter Property="BorderThickness" Value="0,0,0,1" />
            <Setter Property="BorderBrush" Value="{StaticResource BordureClaire}" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource Gris50}" />
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{StaticResource FondInfoClaire}" />
                    <Setter Property="Foreground" Value="{StaticResource TextePrincipal}" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--  Style pour la ListView  -->
        <Style x:Key="ListViewRelevesStyle" TargetType="ListView">
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
        </Style>
    </Page.Resources>

    <!--  ══════════════════════════════════════════════════════════  -->
    <!--  CONTENU PRINCIPAL  -->
    <!--  ══════════════════════════════════════════════════════════  -->
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="30">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <!--  Titre  -->
                <RowDefinition Height="Auto" />
                <!--  Statistiques  -->
                <RowDefinition Height="Auto" />
                <!--  Boutons d'action  -->
                <RowDefinition Height="Auto" />
                <!--  Liste des relevés  -->
            </Grid.RowDefinitions>

            <!--  ══════════════════════════════════════════════════════════  -->
            <!--  SECTION 1 : TITRE  -->
            <!--  ══════════════════════════════════════════════════════════  -->
            <StackPanel Grid.Row="0" Margin="0,0,0,25">
                <TextBlock
                    FontSize="32"
                    FontWeight="Bold"
                    Foreground="{StaticResource CouleurAlerteMoyenne}">
                    <Run Text="⚡" />
                    <Run Text="Gestion de l'électricité" />
                </TextBlock>
                <TextBlock
                    Margin="0,8,0,0"
                    FontSize="15"
                    Foreground="{StaticResource TexteSecondaire}"
                    Text="Suivi des relevés et consommations électriques" />
            </StackPanel>


            <!--  ══════════════════════════════════════════════════════════  -->
            <!--  SECTION 2 : STATISTIQUES RESPONSIVE  -->
            <!--  ══════════════════════════════════════════════════════════  -->
            <Grid Grid.Row="1" Margin="0,0,0,25">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!--  Carte 1 : Dernier relevé  -->
                <Border Grid.Column="0" Style="{StaticResource CarteStatistique}">
                    <StackPanel>
                        <TextBlock
                            FontSize="13"
                            FontWeight="SemiBold"
                            Foreground="{StaticResource TexteSecondaire}"
                            Text="📅 Dernier relevé" />
                        <TextBlock
                            x:Name="TxtDernierReleve"
                            Margin="0,8,0,0"
                            FontSize="24"
                            FontWeight="Bold"
                            Foreground="{StaticResource TextePrincipal}"
                            Text="--/--/----" />
                    </StackPanel>
                </Border>

                <!--  Carte 2 : Consommation du mois  -->
                <Border Grid.Column="1" Style="{StaticResource CarteStatistique}">
                    <StackPanel>
                        <TextBlock
                            FontSize="13"
                            FontWeight="SemiBold"
                            Foreground="{StaticResource TexteSecondaire}"
                            Text="⚡ Consommation mois" />
                        <TextBlock
                            Margin="0,8,0,0"
                            FontSize="24"
                            FontWeight="Bold"
                            Foreground="{StaticResource TextePrincipal}">
                            <Run x:Name="TxtConsoMois" Text="0" />
                            <Run FontSize="16" Text=" kWh" />
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!--  Carte 3 : Moyenne mensuelle  -->
                <Border Grid.Column="2" Style="{StaticResource CarteStatistique}">
                    <StackPanel>
                        <TextBlock
                            FontSize="13"
                            FontWeight="SemiBold"
                            Foreground="{StaticResource TexteSecondaire}"
                            Text="📊 Moyenne mensuelle" />
                        <TextBlock
                            Margin="0,8,0,0"
                            FontSize="24"
                            FontWeight="Bold"
                            Foreground="{StaticResource TextePrincipal}">
                            <Run x:Name="TxtMoyenne" Text="0" />
                            <Run FontSize="16" Text=" kWh" />
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!--  Carte 4 : Coût estimé  -->
                <Border Grid.Column="3" Style="{StaticResource CarteStatistique}">
                    <StackPanel>
                        <TextBlock
                            FontSize="13"
                            FontWeight="SemiBold"
                            Foreground="{StaticResource TexteSecondaire}"
                            Text="💰 Coût estimé mois" />
                        <TextBlock
                            Margin="0,8,0,0"
                            FontSize="24"
                            FontWeight="Bold"
                            Foreground="{StaticResource CouleurPrincipale}">
                            <Run x:Name="TxtCout" Text="0,00" />
                            <Run FontSize="16" Text=" €" />
                        </TextBlock>
                    </StackPanel>
                </Border>
            </Grid>

            <!--  ══════════════════════════════════════════════════════════  -->
            <!--  SECTION 3 : BOUTONS D'ACTION  -->
            <!--  ══════════════════════════════════════════════════════════  -->
            <Border Grid.Row="2" Style="{StaticResource Carte}">
                <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                    <!--  Bouton Ajouter (Vert)  -->
                    <Button Click="BtnAjouter_Click" Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="{StaticResource CouleurSucces}" />
                                <Setter Property="Foreground" Value="White" />
                                <Setter Property="FontSize" Value="18" />
                                <Setter Property="FontWeight" Value="Bold" />
                                <Setter Property="Padding" Value="40,20" />
                                <Setter Property="Margin" Value="0,0,25,0" />
                                <Setter Property="BorderThickness" Value="0" />
                                <Setter Property="MinWidth" Value="260" />
                                <Setter Property="Height" Value="70" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border
                                                x:Name="border"
                                                Background="{TemplateBinding Background}"
                                                CornerRadius="12">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource CouleurSuccesFoncee}" />
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource CouleurSuccesSombre}" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                        <StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="0,0,15,0"
                                VerticalAlignment="Center"
                                FontSize="26"
                                Text="➕" />
                            <TextBlock VerticalAlignment="Center" Text="Ajouter un relevé" />
                        </StackPanel>
                    </Button>

                    <!--  Bouton Modifier (Bleu)  -->
                    <Button
                        x:Name="BtnModifier"
                        Click="BtnModifier_Click"
                        Cursor="Hand"
                        IsEnabled="False">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="{StaticResource CouleurPrincipale}" />
                                <Setter Property="Foreground" Value="White" />
                                <Setter Property="FontSize" Value="18" />
                                <Setter Property="FontWeight" Value="Bold" />
                                <Setter Property="Padding" Value="40,20" />
                                <Setter Property="Margin" Value="0,0,25,0" />
                                <Setter Property="BorderThickness" Value="0" />
                                <Setter Property="MinWidth" Value="220" />
                                <Setter Property="Height" Value="70" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border
                                                x:Name="border"
                                                Background="{TemplateBinding Background}"
                                                CornerRadius="12">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource CouleurPrincipaleInfo}" />
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource CouleurPrincipaleFoncee}" />
                                                </Trigger>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Gris300}" />
                                                    <Setter TargetName="border" Property="Opacity" Value="0.6" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                        <StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="0,0,15,0"
                                VerticalAlignment="Center"
                                FontSize="26"
                                Text="✏️" />
                            <TextBlock VerticalAlignment="Center" Text="Modifier" />
                        </StackPanel>
                    </Button>

                    <!--  Bouton Supprimer (Rouge)  -->
                    <Button
                        x:Name="BtnSupprimer"
                        Click="BtnSupprimer_Click"
                        Cursor="Hand"
                        IsEnabled="False">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="{StaticResource CouleurErreur}" />
                                <Setter Property="Foreground" Value="White" />
                                <Setter Property="FontSize" Value="18" />
                                <Setter Property="FontWeight" Value="Bold" />
                                <Setter Property="Padding" Value="40,20" />
                                <Setter Property="BorderThickness" Value="0" />
                                <Setter Property="MinWidth" Value="220" />
                                <Setter Property="Height" Value="70" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border
                                                x:Name="border"
                                                Background="{TemplateBinding Background}"
                                                CornerRadius="12">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource CouleurErreurFoncee}" />
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource CouleurUrgence}" />
                                                </Trigger>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Gris300}" />
                                                    <Setter TargetName="border" Property="Opacity" Value="0.6" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                        <StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="0,0,15,0"
                                VerticalAlignment="Center"
                                FontSize="26"
                                Text="🗑️" />
                            <TextBlock VerticalAlignment="Center" Text="Supprimer" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!--  ══════════════════════════════════════════════════════════  -->
            <!--  SECTION 4 : HISTORIQUE DES RELEVÉS D'ÉLECTRICITÉ  -->
            <!--  ══════════════════════════════════════════════════════════  -->
            <Border Grid.Row="3" Style="{StaticResource Carte}">
                <Grid>
                    <!--  Titre de la section  -->
                    <TextBlock
                        Margin="0,0,0,20"
                        FontSize="20"
                        FontWeight="Bold"
                        Foreground="{StaticResource TextePrincipal}"
                        Text="📋 HISTORIQUE DES RELEVÉS D'ÉLECTRICITÉ" />

                    <!--  Liste des relevés  -->
                    <ListView
                        x:Name="ListViewReleves"
                        Margin="0,40,0,0"
                        ItemContainerStyle="{StaticResource ListViewItemStyle}"
                        SelectionChanged="ListViewReleves_SelectionChanged"
                        Style="{StaticResource ListViewRelevesStyle}">
                        <ListView.View>
                            <GridView AllowsColumnReorder="False">
                                <!--  1. Date relevé  -->
                                <GridViewColumn Width="180" Header="📅 Date">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter Property="FontSize" Value="16" />
                                            <Setter Property="Foreground" Value="{StaticResource TexteSecondaire}" />
                                            <Setter Property="Padding" Value="10,12" />
                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock
                                                FontSize="15"
                                                FontWeight="SemiBold"
                                                Foreground="{StaticResource TextePrincipal}"
                                                Text="{Binding DateReleve, StringFormat='dd/MM/yyyy'}"
                                                TextAlignment="Center" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>

                                <!--  2. Index compteur  -->
                                <GridViewColumn Width="200" Header="🔢 Index">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter Property="FontSize" Value="16" />
                                            <Setter Property="Foreground" Value="{StaticResource TexteSecondaire}" />
                                            <Setter Property="Padding" Value="10,12" />
                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock
                                                FontSize="15"
                                                Foreground="{StaticResource TexteSecondaire}"
                                                TextAlignment="Center">
                                                <Run Text="{Binding IndexCompteur, StringFormat='{}{0:N0}'}" />
                                                <Run Text=" kWh" />
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>

                                <!--  3. Consommation  -->
                                <GridViewColumn Width="200" Header="📊 Consommation">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter Property="FontSize" Value="16" />
                                            <Setter Property="Foreground" Value="{StaticResource TexteSecondaire}" />
                                            <Setter Property="Padding" Value="10,12" />
                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock
                                                FontSize="16"
                                                FontWeight="Bold"
                                                Foreground="#FF9800"
                                                TextAlignment="Center">
                                                <Run Text="{Binding Consommation, StringFormat='{}{0:N0}'}" />
                                                <Run Text=" kWh" />
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>

                                <!--  4. Coût estimé  -->
                                <GridViewColumn Width="180" Header="💰 Coût">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter Property="FontSize" Value="16" />
                                            <Setter Property="Foreground" Value="{StaticResource TexteSecondaire}" />
                                            <Setter Property="Padding" Value="10,12" />
                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock
                                                FontSize="16"
                                                FontWeight="Bold"
                                                Foreground="#4CAF50"
                                                TextAlignment="Center">
                                                <Run Text="{Binding MontantEstime, StringFormat='{}{0:F2}'}" />
                                                <Run Text=" €" />
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>

                                <!--  5. Notes  -->
                                <GridViewColumn Width="340" Header="📝 Notes">
                                    <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="FontWeight" Value="Bold" />
                                            <Setter Property="FontSize" Value="16" />
                                            <Setter Property="Foreground" Value="{StaticResource TexteSecondaire}" />
                                            <Setter Property="Padding" Value="10,12" />
                                            <Setter Property="HorizontalContentAlignment" Value="Left" />
                                        </Style>
                                    </GridViewColumn.HeaderContainerStyle>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock
                                                FontSize="14"
                                                FontStyle="Italic"
                                                Foreground="{StaticResource TexteClair}"
                                                Text="{Binding Notes}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                ToolTip="{Binding Notes}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>

                    <!--  Message vide  -->
                    <StackPanel
                        x:Name="MessageVide"
                        Margin="0,40,0,0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Visibility="Collapsed">
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="64"
                            Opacity="0.3"
                            Text="⚡" />
                        <TextBlock
                            Margin="0,15,0,0"
                            HorizontalAlignment="Center"
                            FontSize="18"
                            Foreground="{StaticResource TexteSecondaire}"
                            Text="Aucun relevé enregistré" />
                        <TextBlock
                            Margin="0,8,0,0"
                            HorizontalAlignment="Center"
                            FontSize="14"
                            Foreground="{StaticResource TexteSecondaire}"
                            Text="Cliquez sur 'Ajouter un relevé' pour commencer" />
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </ScrollViewer>
</Page>
